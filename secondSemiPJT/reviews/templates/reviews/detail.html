{% extends 'base.html' %}
{% load django_bootstrap5 %}

{% block content %}
  <p>{{ review.user.username }}
    <small class="text-muted">{{ review.created_at }}</small>
  </p>
  <p>{{ review.content }}</p>
  <div>
    {% if review.review_image %}
      <img src="{{ review.review_image.url }}" alt="">
    {% endif %}
  </div>
  <div class="d-flex justify-content-end">
    {% if request.user == review.user %}
      <a href="{% url 'reviews:update' review.pk %}" class="btn btn-light">리뷰 수정</a>
      <a href="{% url 'reviews:delete' review.pk %}" class="btn btn-danger">리뷰 삭제</a>
    {% endif %}
  </div>
  <form action="{% url 'reviews:add_comment' review.pk %}" method="POST" class="mt-3">
    {% csrf_token %}
    {% bootstrap_form comment_form %}
    <button type="submit" class="btn btn-primary">댓글 등록</button>
  </form>
  <hr>
  <div class="mt-3 mb-3">
    {% for comment in review.comments.all %}
      <p>{{ comment.user}}
        {{ comment.content }}</p>
      <p class="text-muted">{{ comment.created_at }}</p>
      {% if request.user == comment.user %}
        <a href="{% url 'reviews:delete_comment' review.pk comment.pk %}" class="btn btn-danger">댓글 삭제</a>
      {% endif %}
    {% endfor %}
  </div>
{% endblock content %}